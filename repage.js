/* repage.js - https://github.com/rstacruz/repage.js
 * includes page.js - https://github.com/visionmedia/page.js
 * @license MIT */
!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;"undefined"!=typeof window?e=window:"undefined"!=typeof global?e=global:"undefined"!=typeof self&&(e=self),e.page=t()}}(function(){var t,e,n;return function i(t,e,n){function r(o,s){if(!e[o]){if(!t[o]){var f=typeof require=="function"&&require;if(!s&&f)return f(o,!0);if(a)return a(o,!0);var u=new Error("Cannot find module '"+o+"'");throw u.code="MODULE_NOT_FOUND",u}var c=e[o]={exports:{}};t[o][0].call(c.exports,function(e){var n=t[o][1][e];return r(n?n:e)},c,c.exports,i,t,e,n)}return e[o].exports}var a=typeof require=="function"&&require;for(var o=0;o<n.length;o++)r(n[o]);return r}({1:[function(t,e,n){var i=t("page");var r=this.setImmediate?this.setImmediate:function(t){window.setTimeout(t,0)};function a(t,e){if("function"==typeof t){return a("*",t)}if("function"==typeof e){i(t,e)}else if("string"===typeof t){a.show(t,e)}else{a.start(t)}}a.start=i.start;a.stop=i.stop;a.dispatch=i.dispatch;a.show=function(t,e,n){var r=a.uri(t,e);i.show(r,{},n)};a.replace=function(t,e,n,r){var o=a.uri(t,e);i.replace(o,{},n,r)};a.len=0;a.uri=function(t,e){var n=t;if(e){n=t.replace(/:([A-Za-z_]+)/g,function(t,n){var i=e[n];delete e[n];return i})}if(e&&Object.keys(e).length>0){n+="?"+a.querystring(e)}return n};a.querystring=function(t,e){var n=[],i;if(Array.isArray(t)){for(var r=0,o=t.length;r<o;r++){i=t[r];n.push(a.querystring({"":i},e))}}else if(typeof t==="object"){for(var s in t){if(!t.hasOwnProperty(s))continue;i=t[s];if(typeof i==="undefined")continue;if(e)s=e+"["+s+"]";if(i===null){n.push(s+"=")}else if(typeof i==="object"){n.push(a.querystring(i,s))}else{n.push([s,encodeURIComponent(i)].join("="))}}}return n.join("&")};a.back=function(t,e){if(a.len>0){history.back()}else if(t){a(t,e)}};a.redirect=function(t,e){r(function(){a.replace(t,e)})};a.teardown=function(){a.stop();a.len=0;i.callbacks=[]};var o=i.Context.prototype.pushState;i.Context.prototype.pushState=function(){a.len++;o.apply(this,arguments)};a.page=i;e.exports=a},{page:2}],2:[function(t,e,n){(function(){var t=true;var n="";var i;function r(t,e){if("function"==typeof t){return r("*",t)}if("function"==typeof e){var n=new s(t);for(var i=1;i<arguments.length;++i){r.callbacks.push(n.middleware(arguments[i]))}}else if("string"==typeof t){r.show(t,e)}else{r.start(t)}}r.callbacks=[];r.base=function(t){if(0==arguments.length)return n;n=t};r.start=function(e){e=e||{};if(i)return;i=true;if(false===e.dispatch)t=false;if(false!==e.popstate)window.addEventListener("popstate",u,false);if(false!==e.click)window.addEventListener("click",c,false);if(!t)return;var n=location.pathname+location.search+location.hash;r.replace(n,null,true,t)};r.stop=function(){i=false;removeEventListener("click",c,false);removeEventListener("popstate",u,false)};r.show=function(t,e,n){var i=new o(t,e);if(false!==n)r.dispatch(i);if(!i.unhandled)i.pushState();return i};r.replace=function(t,e,n,i){var a=new o(t,e);a.init=n;if(null==i)i=true;if(i)r.dispatch(a);a.save();return a};r.dispatch=function(t){var e=0;function n(){var i=r.callbacks[e++];if(!i)return a(t);i(t,n)}n()};function a(t){var e=window.location.pathname+window.location.search;if(e==t.canonicalPath)return;r.stop();t.unhandled=true;window.location=t.canonicalPath}function o(t,e){if("/"==t[0]&&0!=t.indexOf(n))t=n+t;var i=t.indexOf("?");this.canonicalPath=t;this.path=t.replace(n,"")||"/";this.title=document.title;this.state=e||{};this.state.path=t;this.querystring=~i?t.slice(i+1):"";this.pathname=~i?t.slice(0,i):t;this.params=[];this.hash="";if(!~this.path.indexOf("#"))return;var r=this.path.split("#");this.path=r[0];this.hash=r[1]||"";this.querystring=this.querystring.split("#")[0]}r.Context=o;o.prototype.pushState=function(){history.pushState(this.state,this.title,this.canonicalPath)};o.prototype.save=function(){history.replaceState(this.state,this.title,this.canonicalPath)};function s(t,e){e=e||{};this.path=t;this.method="GET";this.regexp=f(t,this.keys=[],e.sensitive,e.strict)}r.Route=s;s.prototype.middleware=function(t){var e=this;return function(n,i){if(e.match(n.path,n.params))return t(n,i);i()}};s.prototype.match=function(t,e){var n=this.keys,i=t.indexOf("?"),r=~i?t.slice(0,i):t,a=this.regexp.exec(r);if(!a)return false;for(var o=1,s=a.length;o<s;++o){var f=n[o-1];var u="string"==typeof a[o]?decodeURIComponent(a[o]):a[o];if(f){e[f.name]=undefined!==e[f.name]?e[f.name]:u}else{e.push(u)}}return true};function f(t,e,n,i){if(t instanceof RegExp)return t;if(t instanceof Array)t="("+t.join("|")+")";t=t.concat(i?"":"/?").replace(/\/\(/g,"(?:/").replace(/(\/)?(\.)?:(\w+)(?:(\(.*?\)))?(\?)?/g,function(t,n,i,r,a,o){e.push({name:r,optional:!!o});n=n||"";return""+(o?"":n)+"(?:"+(o?n:"")+(i||"")+(a||(i&&"([^/.]+?)"||"([^/]+?)"))+")"+(o||"")}).replace(/([\/.])/g,"\\$1").replace(/\*/g,"(.*)");return new RegExp("^"+t+"$",n?"":"i")}function u(t){if(t.state){var e=t.state.path;r.replace(e,t.state)}}function c(t){if(1!=p(t))return;if(t.metaKey||t.ctrlKey||t.shiftKey)return;if(t.defaultPrevented)return;var e=t.target;while(e&&"A"!=e.nodeName)e=e.parentNode;if(!e||"A"!=e.nodeName)return;var i=e.getAttribute("href");if(e.pathname==location.pathname&&(e.hash||"#"==i))return;if(e.target)return;if(!h(e.href))return;var a=e.pathname+e.search+(e.hash||"");var o=a+e.hash;a=a.replace(n,"");if(n&&o==a)return;t.preventDefault();r.show(o)}function p(t){t=t||window.event;return null==t.which?t.button:t.which}function h(t){var e=location.protocol+"//"+location.hostname;if(location.port)e+=":"+location.port;return 0==t.indexOf(e)}if("undefined"==typeof e){window.page=r}else{e.exports=r}})()},{}]},{},[1])(1)});